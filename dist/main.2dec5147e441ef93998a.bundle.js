(()=>{"use strict";var __webpack_modules__={107:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function parse(value=""){if(value.startsWith("="))try{return eval(value.slice(1))}catch(t){return value}return value}__webpack_require__.d(__webpack_exports__,{Q:()=>parse})}},__webpack_module_cache__={};function __webpack_require__(t){if(__webpack_module_cache__[t])return __webpack_module_cache__[t].exports;var e=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](e,e.exports,__webpack_require__),e.exports}__webpack_require__.d=(t,e)=>{for(var s in e)__webpack_require__.o(e,s)&&!__webpack_require__.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{class t{constructor(t){this.$el="string"==typeof t?document.querySelector(t):t}html(t){return"string"==typeof t?(this.$el.innerHTML=t,this):this.$el.outerHTML.trim()}text(t){return void 0!==t?(this.$el.textContent=t,this):"input"===this.$el.tagName.toLowerCase()?this.$el.value.trim():this.$el.textContent.trim()}clear(){return this.html(""),""}on(t,e){this.$el.addEventListener(t,e)}off(t,e){this.$el.removeEventListener(t,e)}append(e){return e instanceof t&&(e=e.$el),Element.prototype.append?this.$el.append(e):this.$el.appendChild(e),this}get data(){return this.$el.dataset}getOffset(){return this.$el.getBoundingClientRect()}getClosest(t){return e(this.$el.closest(t))}find(t){return e(this.$el.querySelector(t))}findAll(t){return this.$el.querySelectorAll(t)}focus(){return this.$el.focus(),this}attr(t,e){return e?(this.$el.setAttribute(t,e),this):this.$el.getAttribute(t)}id(t){if(t){const t=this.id().split(":");return{row:+t[0],col:+t[1]}}return this.data.id}css(t={}){Object.keys(t).map((e=>this.$el.style[e]=t[e]))}addClass(t){return this.$el.classList.add(t),this}getStyles(t=[]){return t.reduce(((t,e)=>(t[e]=this.$el.style[e],t)),{})}removeClass(t){return this.$el.classList.remove(t),this}}function e(e){return new t(e)}e.create=(t,s="")=>{const r=document.createElement(t);return s&&r.classList.add(s),e(r)};class s{static get path(){return window.location.hash.slice(1)}static get param(){return s.path.split("/")[1]}static rout(t){return window.location.hash=t}}class r{constructor(t){this.params=t}getRoot(){throw new Error('Method "getRoot" should be implemented')}afterRender(){}destroy(){}}function n(t,e){return t>e&&([t,e]=[e,t]),new Array(e-t+1).fill("").map(((e,s)=>t+s))}function i(t,e=null){if(!e)return JSON.parse(localStorage.getItem(t));localStorage.setItem(t,JSON.stringify(e))}function a(t,e){let s;return function(...r){clearTimeout(s),s=setTimeout((()=>{clearTimeout(s),t.apply(this,r)}),e)}}function o(t){const e=i(t);return`\n    <li class="db__record">\n        <a href="#excel/${t.split(":")[1]}">${e.titleApp}</a>\n        <strong>${new Date(e.dateOpenedPage).toLocaleDateString()}\n                ${new Date(e.dateOpenedPage).toLocaleTimeString()}\n        </strong>\n    </li>`}function l(t){return`on${function(t){return"string"!=typeof t?"":t.charAt(0).toUpperCase()+t.slice(1)}(t)}`}class c extends class{constructor(t,e=[]){if(!t)throw new Error("Root is not defined");this.$root=t,this.listeners=e}initDomListeners(){this.listeners.forEach((t=>{const e=l(t)||"";if(!this[e])throw new Error(`Meth ${e} wasn't implement ${this.$root}`);this[e]=this[e].bind(this),this.$root.on(t,this[e])}))}removeDomListeners(){this.listeners.forEach((t=>{const e=l(t);this.$root.off(t,this[e])}))}}{constructor(t,e={}){super(t,e.listeners),this.emitter=e.emitter,this.store=e.store,this.unsubscribe=[],this.storeSub=null,this.subscribe=e.subscribe||[],this.prepare()}toHTML(){return""}prepare(){}init(){this.initDomListeners()}storeChange(t){console.log(t)}isWatching(t){return this.subscribe.includes(t)}$emit(t,...e){this.emitter.emit(t,...e)}$on(t,e){this.emitter.subscribe(t,e)}$dispatch(t){this.store.dispatch(t)}$subscribe(t){this.storeSub=this.store.subscribe(t)}destroy(){this.removeDomListeners()}}const u="TABLE_RESIZE",h="TEXT_CHANGE",d="STYLES_CHANGE",p="APPLY_STYLES",b="TITLE_CHANGE",f="UPDATE_TIME",m={textAlign:"left",fontWeight:"normal",fontStyle:"normal",textDecoration:"none"};class _ extends c{constructor(t,e){super(t,{name:"Header",listeners:["input","click"],...e})}prepare(){this.onInput=a(this.onInput,300)}toHTML(){return`\n      <input type="text" \n        class="input" \n        placeholder="Add new table" \n        value='${this.store.getState().titleApp||"Title app"}'/>\n      <div class="flex-row">\n        <button class="button" data-button="exit">\n          <i class="material-icons" data-button="exit">exit_to_app</i>\n        </button>\n        <button class="button" data-button="remove">\n          <i class="material-icons" data-button="remove">delete</i>\n        </button>`}onInput(t){const s=e(t.target);var r;this.$dispatch((r=s.text(),{type:b,data:r}))}onClick(t){const r=e(t.target);"remove"===r.data.button?confirm("You want to delete this table, are you sure?")&&(localStorage.removeItem(`excel:${s.param}`),s.rout("")):"exit"===r.data.button&&s.rout("")}}!function(t,e,s){e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s}(_,"className","excel__header");class g extends c{constructor(...t){super(...t)}initState(t={}){this.state={...t}}setState(t){this.state={...this.state,...t},this.$root.html(this.template)}toHTML(){}get template(){return JSON.stringify(this.state,null,2)}}function v(t){const e=`data-type="button" \n         data-value='${JSON.stringify(t.value)}'\n        `;return`\n      <button \n        class="button ${t.active?"active":""}"\n        ${e}\n        >\n        <i class="material-icons" ${e}>${t.icon}</i>\n      </button>\n    `}class w extends g{constructor(t,e){super(t,{name:"Toolbar",listeners:["click"],subscribe:["currentStyles"],...e})}prepare(){this.initState(m)}toHTML(){return this.template}get template(){return[{icon:"format_align_left",active:"left"===(t=this.state).textAlign,value:{textAlign:"left"}},{icon:"format_align_center",active:"center"===t.textAlign,value:{textAlign:"center"}},{icon:"format_align_right",active:"right"===t.textAlign,value:{textAlign:"right"}},{icon:"format_bold",active:"bold"===t.fontWeight,value:{fontWeight:"bold"===t.fontWeight?"normal":"bold"}},{icon:"format_italic",active:"italic"===t.fontStyle,value:{fontStyle:"italic"===t.fontStyle?"normal":"italic"}},{icon:"format_underlined",active:"underline"===t.textDecoration,value:{textDecoration:"underline"===t.textDecoration?"none":"underline"}}].map(v).join(" ");var t}storeChange(t){this.setState(t.currentStyles)}onClick(t){const s=e(t.target);if("button"===s.data.type){const t=JSON.parse(s.data.value);this.$emit("toolbar:applyStyle",t)}}}!function(t,e,s){e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s}(w,"className","excel__toolbar");class y extends c{constructor(t,e){super(t,{name:"Formula",listeners:["input","keydown"],subscribe:["currentText"],...e})}init(){super.init(),this.$formula=this.$root.find("#formula-input"),this.$on("table:select",(t=>{this.$formula.text(t.data.value)}))}storeChange({currentText:t}){this.$formula.text(t)}toHTML(){return'<div class="info">fn</div>\n                <div class="input" \n                  id="formula-input"\n                  contenteditable \n                  spellcheck="false">\n                </div>'}onInput(t){this.$emit("formula:input",e(t.target).text())}onKeydown(t){["Enter","Tab"].includes(t.key)&&(t.preventDefault(),this.$emit("formula:done"))}}!function(t,e,s){e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s}(y,"className","excel__formula");var $=__webpack_require__(107);const S=65,x=90;function E({el:t,idx:e,width:s}){return`<div class="column" \n              data-type="resizable" \n              data-col=${e}\n              style="width: ${s}"\n              >\n              ${t}\n             <div class="resize-col" data-resize="col"></div>\n            </div>`}function T(t,e="",s){const r=e?'<div class="resize-row" data-resize="row"></div>':"";return`<div class="row" \n                data-type="resizable"\n                 data-row=${e}\n                 style="height: ${function(t,e){return(e[t]||24)+"px"}(e,s)}">\n                <div class="row-info">${e}\n                  ${r}\n                </div>\n                <div class="row-data">${t}</div>\n              </div>\n             `}function A(t,e){return function(s,r){const n=`${t}:${r}`,i=C(r,e.colState),a=e.dataState[n];return`<div class="cell" \n                    contenteditable \n                    data-col=${r} \n                    data-id=${n}\n                    data-type="cell"\n                    data-value="${a||""}"\n                    width=${i}\n                    style="${function(t={}){return Object.keys(t).map((e=>{return`${s=e,s.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()))}:${t[e]}`;var s})).join(";")}({...m,...e.stylesState[n]})}">\n                    ${(0,$.Q)(a)||""} \n                </div>`}}function C(t,e){return(e[t]||120)+"px"}class k{constructor(){this.group=[],this.current=null}select(t){this.clear(),this.group.push(t),this.current=t,t.focus().addClass(k.className)}selectGroup(t=[]){this.clear(),this.group=t,this.group.map((t=>t.addClass(k.className)))}applyStyle(t){this.group.forEach((e=>e.css(t)))}get selectedIds(){return this.group.map((t=>t.id()))}clear(){this.group.map((t=>t.removeClass(k.className))),this.group=[]}}!function(t,e,s){e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s}(k,"className","selected");class O extends c{constructor(t,e){super(t,{name:"Table",listeners:["mousedown","keydown","input"],...e})}toHTML(){return t=35,e=this.store.getState(),function(t,e={}){const s=x-S+1,r=[],n=new Array(s).fill("").map(((t,e)=>String.fromCharCode(S+e))).map(function(t){return function(e,s){return{el:e,idx:s,width:C(s,t.colState)}}}(e)).map(E).join(" ");r.push(T(n,null,{}));for(let n=0;n<t;n++){const t=new Array(s).fill("").map(A(n,e)).join(" ");r.push(T(t,n+1,e.rowState))}return r.join(" ")}(t,e);var t,e}init(){super.init(),this.selection=new k;const t=this.$root.find('[data-id="0:0"]');this.selectCell(t),this.$on("formula:input",(t=>{this.selection.current.attr("data-value",t).text((0,$.Q)(t)),this.updateTextInStore(t)})),this.$on("formula:done",(t=>{this.selection.current.focus()})),this.$on("toolbar:applyStyle",(t=>{var e;this.selection.applyStyle(t),this.$dispatch((e={value:t,ids:this.selection.selectedIds},{type:p,data:e}))}))}selectCell(t){this.selection.select(t),this.$emit("table:select",t);const e=t.getStyles(Object.keys(m));this.$dispatch({type:d,data:e})}async tableResize(t){try{const s=await function(t,s){return new Promise((r=>{const n=e(s.target),i=n.getClosest('[data-type="resizable"]'),a=i.getOffset(),o=i.data.col,l=n.data.resize;let c;document.onmousemove=t=>{const e="col"===l?"bottom":"right";if(n.css({[e]:"-5000px",opacity:1}),"col"===l){const e=t.pageX-a.right;c=a.width+e,n.css({right:-e+"px"})}else{const e=t.pageY-a.bottom;c=a.height+e,n.css({bottom:-e+"px"})}},document.onmouseup=e=>{if(document.onmousemove=null,document.onmouseup=null,"col"===l)i.$el.style.width=c+"px",i.css({width:`${c}px`}),t.findAll(`[data-col="${o}"]`).forEach((t=>t.style.width=c+"px"));else{const t=e.pageY-a.bottom;c=a.height+t,i.css({height:`${c}px`})}r({value:c,type:l,id:i.data[l]}),n.css({opacity:0,bottom:0,right:0})}}))}(this.$root,t);this.$dispatch(function(t){return{type:u,data:t}}(s))}catch(t){console.warn("Error",t.message)}}onMousedown(t){if(function(t){return t.target.dataset.resize}(t))this.tableResize(t);else if(function(t){return"cell"===t.target.dataset.type}(t)){const i=e(t.target);if(t.shiftKey){const t=i.id(!0),e=this.selection.current.id(!0),a=(s=n(e.col,t.col),r=n(e.row,t.row),s.reduce(((t,e)=>(r.forEach((s=>t.push(`${s}:${e}`))),t)),[])).map((t=>this.$root.find(`[data-id="${t}"]`)));this.selection.selectGroup(a)}else this.selectCell(i)}var s,r}storeChange(t){console.log("changes",t)}updateTextInStore(t){var e;this.$dispatch((e={id:this.selection.current.id(),value:t},{type:h,data:e}))}onInput(t){this.updateTextInStore(e(t.target).text())}onKeydown(t){const{key:e}=t;if(["Tab","Enter","ArrowRight","ArrowLeft","ArrowUp","ArrowDown"].includes(e)&&!t.shiftKey){t.preventDefault();const{row:s,col:r}=this.selection.current.id(!0),n=this.$root.find(function(t,e,s){switch(t){case"Tab":case"ArrowRight":s++;break;case"Enter":case"ArrowDown":e++;break;case"ArrowUp":e=0===e?0:e-1;break;case"ArrowLeft":s=0===s?0:s-1}return`[data-id="${e}:${s}"]`}(e,s,r));this.selectCell(n)}}}!function(t,e,s){e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s}(O,"className","excel__table");class L{constructor(){this.listeners={}}emit(t,...e){return!!Array.isArray(this.listeners[t])&&(this.listeners[t].forEach((t=>t(...e))),!0)}subscribe(t,e){return this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(e),()=>{this.listeners[t]=this.listeners[t].filter((t=>t!=e))}}}class N{constructor(t){this.store=t,this.sub=null,this.prevState={}}subscribeComponents(t){this.prevState=this.store.getState(),this.sub=this.store.subscribe((e=>{Object.keys(e).forEach((s=>{var r,n;r=this.prevState[s],n=e[s],("object"==typeof r&&"object"==typeof n?JSON.stringify(r)===JSON.stringify(n):r===n)||t.forEach((t=>{if(t.isWatching(s)){const r={[s]:e[s]};t.storeChange(r)}}))})),this.prevState=this.store.getState()}))}unsubscribeFromStore(){this.sub.unsubscribe()}}class D{constructor(t){this.components=t.components||[],this.emitter=new L,this.store=t.store,this.subscriber=new N(this.store)}getRoot(){const t={emitter:this.emitter,store:this.store},s=e.create("div","excel");return this.components=this.components.map((r=>{const n=e.create("div",r.className),i=new r(n,t);return n.html(i.toHTML()),s.append(n),i})),s}init(){this.store.dispatch({type:f}),this.subscriber.subscribeComponents(this.components),this.components.forEach((t=>t.init()))}destroy(){this.subscriber.unsubscribeFromStore(),this.components.forEach((t=>t.destroy()))}}function j(t,e){let s,r;switch(e.type){case u:return s="col"===e.data.type?"colState":"rowState",{...t,[s]:H(t,s,e)};case h:return s="dataState",{...t,currentText:e.data.value,dataState:H(t,s,e)};case d:return{...t,currentStyles:e.data};case p:return s="stylesState",r=t[s]||{},e.data.ids.forEach((t=>{r[t]={...r[t],...e.data.value}})),{...t,[s]:r,currentStyles:{...t.currentStyles,...e.data.value}};case b:return{...t,titleApp:e.data};case f:return{...t,dateOpenedPage:(new Date).toJSON()};default:return t}}function H(t,e,s){const r=t[e]||{};return r[s.data.id]=s.data.value,r}const I={colState:{},rowState:{},dataState:{},stylesState:{},currentText:"",currentStyles:m,titleApp:"Table title",dateOpenedPage:(new Date).toJSON()};function R(t){return"excel:"+t}new class{constructor(t,s){if(!t)throw new Error("Selector is not providing in Route");this.$placeholder=e(t),this.routes=s,this.page=null,this.hashChangeHandler=this.hashChangeHandler.bind(this),this.init()}init(){window.addEventListener("hashchange",this.hashChangeHandler),this.hashChangeHandler()}hashChangeHandler(){this.page&&this.page.destroy(),this.$placeholder.clear();const t=s.path.includes("excel")?this.routes.excel:this.routes.dashboard;this.page=new t(s.param),this.$placeholder.append(this.page.getRoot()),this.page.afterRender()}destroy(){window.removeEventListener("hashchange",this.hashChangeHandler)}}("#app",{dashboard:class extends r{getRoot(){const t=Date.now().toString();return e.create("div","db").html(`<div class="db__header">\n               <h1>DashboardPage Excel</h1>\n           </div>\n        <div class="db__new">\n            <div class="db__view">\n                <a href="#excel/${t}" class="db__create">\n                    New <br/> table\n                </a>\n            </div>\n        </div>\n        ${function(){const t=function(){const t=[];for(let e=0;e<localStorage.length;e++){const s=localStorage.key(e);s.includes("excel")&&t.push(s)}return t}();return t.length?`\n        <div class="db__table db__view">\n            <div class="db__list-header">\n                <span>Name</span>\n                <span>Open date</span>\n            </div>\n            <ul class="db__list">\n                ${t.map(o).join("")}\n            </ul>\n        </div>`:'<p class="db__table db__view"> There is any table here</p>'}()}\n        `)}destroy(){super.destroy()}},excel:class extends r{getRoot(){const t=this.params?this.params:Date.now().toString(),e=function(t,e={}){let s=t({...e},{type:"__INIT__"}),r=[];return{subscribe:t=>(r.push(t),{unsubscribe(){r=r.filter((e=>e!==t))}}),dispatch(e){s=t(s,e),r.forEach((t=>t(s)))},getState:()=>JSON.parse(JSON.stringify(s))}}(j,(r=i(R(t)))?(t=>({...t,currentText:"",currentStyles:m}))(r):function(t){return JSON.parse(JSON.stringify(t))}(I)),s=a((e=>{i(R(t),e)}),300);var r;return e.subscribe(s),this.excel=new D({components:[_,w,y,O],store:e}),this.excel.getRoot()}afterRender(){this.excel.init()}destroy(){this.excel.destroy()}}})})()})();